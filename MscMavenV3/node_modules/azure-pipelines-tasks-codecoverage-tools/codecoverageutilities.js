"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isCodeCoverageFileEmpty = void 0;
const Q = require("q");
const tl = require("azure-pipelines-task-lib/task");
const util = require("./utilities");
function isCodeCoverageFileEmpty(codeCoverageFile, codeCoverageTool) {
    if (!tl.exist(codeCoverageFile)) {
        return Q.resolve(true);
    }
    return util.readXmlFileAsJson(codeCoverageFile)
        .then(function (resp) {
        if (resp) {
            if (codeCoverageTool.toLowerCase() === 'jacoco' && resp.report && resp.report.counter) {
                return Q.resolve(false);
            }
            else if (codeCoverageTool.toLowerCase() === 'cobertura' && resp.coverage) {
                let lines_covered = Number(resp.coverage.$["lines-covered"]);
                if (lines_covered && lines_covered > 0) {
                    return Q.resolve(false);
                }
            }
        }
        return Q.resolve(true);
    });
}
exports.isCodeCoverageFileEmpty = isCodeCoverageFileEmpty;
